# Module 04: System Exploitation

Master the art of exploiting systems after gaining initial access, from enumeration to privilege escalation and post-exploitation.

## Module Overview

System exploitation focuses on what happens after you breach a system's perimeter. This module covers the complete attack chain: enumerating the target, establishing persistent access, escalating privileges, and achieving your objectives.

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                        SYSTEM EXPLOITATION WORKFLOW                         │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│   [Initial Access]                                                          │
│         │                                                                   │
│         ▼                                                                   │
│   ┌─────────────┐     ┌─────────────┐     ┌─────────────────────────────┐  │
│   │ Enumeration │ ──► │   Shells    │ ──► │ Privilege Escalation        │  │
│   │ (Recon)     │     │ (Foothold)  │     │ (Root/SYSTEM)               │  │
│   └─────────────┘     └─────────────┘     └─────────────────────────────┘  │
│                                                     │                       │
│                                                     ▼                       │
│   ┌─────────────────────┐     ┌─────────────────────────────────────────┐  │
│   │ Post-Exploitation   │ ◄── │ Password Attacks / Credential Harvest  │  │
│   │ (Persistence, Pivot)│     └─────────────────────────────────────────┘  │
│   └─────────────────────┘                                                   │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

## Learning Objectives

By completing this module, you will be able to:

- Enumerate Linux and Windows systems to identify attack vectors
- Establish and maintain shell access using various techniques
- Escalate privileges from low-privilege user to root/SYSTEM
- Exploit buffer overflow vulnerabilities in vulnerable applications
- Crack passwords and perform credential attacks
- Maintain persistence and move laterally through networks

## Module Sections

| Section | Topic | Difficulty | Duration |
|---------|-------|------------|----------|
| 01 | [System Enumeration](./01-enumeration/) | Intermediate | 2 hrs |
| 02 | [Shell Techniques](./02-shells/) | Intermediate | 2 hrs |
| 03 | [Privilege Escalation](./03-privilege-escalation/) | Advanced | 4 hrs |
| 04 | [Buffer Overflow](./04-buffer-overflow/) | Advanced | 3 hrs |
| 05 | [Password Attacks](./05-password-attacks/) | Intermediate | 2 hrs |
| 06 | [Post-Exploitation](./06-post-exploitation/) | Advanced | 3 hrs |

**Total Estimated Time:** 16+ hours

## Prerequisites

Before starting this module, you should:

- Complete Module 01 (Foundations) and Module 03 (Web Security)
- Have basic Linux command line skills
- Understand networking fundamentals (TCP/IP, ports, protocols)
- Be familiar with basic programming concepts (Python preferred)

## CyberLab Target Systems

This module uses the following Docker services:

| Service | Port | Description |
|---------|------|-------------|
| Buffer Overflow Server | 9999 | Custom vulnerable C server for binary exploitation |
| Vulnerable SSH | 2222 | SSH with weak crypto and default credentials |
| Vulnerable FTP | 2121 | FTP with anonymous access |
| DVWA | 8081 | Web app for command injection to shell |

### Starting the Lab Environment

```bash
# Start all services
cd ~/cyberlab/docker && docker-compose up -d

# Verify services are running
docker ps --format "table {{.Names}}\t{{.Ports}}\t{{.Status}}"

# Connect to buffer overflow server
nc localhost 9999

# Connect to vulnerable SSH
ssh -p 2222 labuser@localhost
# Password: labpass123
```

## Labs Overview

### Lab 1: Linux System Enumeration
**Difficulty:** Intermediate | **Duration:** 45 min

Learn to gather critical information from a compromised Linux system.

**Objectives:**
- Identify system information, users, and groups
- Find interesting files, SUID binaries, and cron jobs
- Map network configuration and running services
- Use automated enumeration scripts

### Lab 2: Windows System Enumeration
**Difficulty:** Intermediate | **Duration:** 45 min

Enumerate Windows systems for privilege escalation vectors.

**Objectives:**
- Gather system and user information
- Find installed software and scheduled tasks
- Identify unquoted service paths and weak permissions
- Use PowerShell for enumeration

### Lab 3: Reverse Shell Fundamentals
**Difficulty:** Intermediate | **Duration:** 45 min

Master establishing reverse shell connections.

**Objectives:**
- Set up listeners with netcat and other tools
- Create reverse shells in multiple languages
- Stabilize and upgrade shells
- Evade basic detection

### Lab 4: Bind Shells and Web Shells
**Difficulty:** Intermediate | **Duration:** 45 min

Learn alternative shell techniques.

**Objectives:**
- Set up bind shell listeners on targets
- Deploy web shells via file upload
- Interact with web shells
- Understanding when to use each type

### Lab 5: Linux Privilege Escalation - SUID/Sudo
**Difficulty:** Intermediate | **Duration:** 1 hr

Escalate privileges using misconfigurations.

**Objectives:**
- Find and exploit SUID binaries
- Exploit sudo misconfigurations
- Use GTFOBins for privilege escalation
- Exploit PATH hijacking

### Lab 6: Linux Privilege Escalation - Kernel & Services
**Difficulty:** Advanced | **Duration:** 1 hr

Advanced Linux privilege escalation techniques.

**Objectives:**
- Identify vulnerable kernel versions
- Exploit kernel vulnerabilities (Dirty Cow, etc.)
- Exploit vulnerable services
- Escape restricted environments

### Lab 7: Windows Privilege Escalation
**Difficulty:** Advanced | **Duration:** 1.5 hrs

Escalate to SYSTEM on Windows targets.

**Objectives:**
- Exploit unquoted service paths
- Abuse weak service permissions
- Use token impersonation
- Exploit always install elevated

### Lab 8: Buffer Overflow - Stack Smashing
**Difficulty:** Advanced | **Duration:** 2 hrs | **Target:** `nc localhost 9999`

Exploit the custom buffer overflow server.

**Objectives:**
- Understand stack memory layout
- Find buffer overflow offset
- Overwrite return address
- Call the secret function to get flag

**Flag:** `FLAG{buff3r_0v3rfl0w_m4st3r}`

### Lab 9: Password Cracking
**Difficulty:** Intermediate | **Duration:** 1 hr

Crack password hashes with various techniques.

**Objectives:**
- Identify hash types
- Use dictionary attacks
- Apply rule-based attacks
- Crack Linux shadow and Windows SAM hashes

### Lab 10: Persistence and Lateral Movement
**Difficulty:** Advanced | **Duration:** 1.5 hrs

Maintain access and move through networks.

**Objectives:**
- Establish persistent access mechanisms
- Perform lateral movement techniques
- Tunnel traffic through compromised hosts
- Exfiltrate data securely

## Tools Used in This Module

### Enumeration
- **LinPEAS/WinPEAS** - Automated privilege escalation enumeration
- **Linux Smart Enumeration (LSE)** - Linux enumeration script
- **PowerUp** - Windows privilege escalation checks
- **Seatbelt** - Windows security enumeration

### Shells
- **netcat** - Swiss army knife for networking
- **pwncat** - Fancy reverse shell handler
- **Meterpreter** - Advanced shell with post modules

### Exploitation
- **gdb/pwntools** - Binary exploitation
- **Metasploit** - Exploitation framework
- **searchsploit** - Exploit database search

### Password Attacks
- **John the Ripper** - Password cracker
- **Hashcat** - GPU password cracker
- **Hydra** - Online brute forcer

## Flags in This Module

| Lab | Flag |
|-----|------|
| Buffer Overflow | `FLAG{buff3r_0v3rfl0w_m4st3r}` |
| SUID Privesc | `FLAG{su1d_pr1v3sc_pwn3d}` |
| Kernel Exploit | `FLAG{k3rn3l_pwn3d}` |
| Shell Stabilization | `FLAG{st4bl3_tty_sh3ll}` |
| Pass the Hash | `FLAG{p4ss_th3_h4sh}` |

## Resources

### References
- [GTFOBins](https://gtfobins.github.io/) - Unix binaries for privilege escalation
- [LOLBAS](https://lolbas-project.github.io/) - Windows Living Off The Land binaries
- [HackTricks](https://book.hacktricks.xyz/) - Comprehensive hacking techniques
- [PayloadsAllTheThings](https://github.com/swisskyrepo/PayloadsAllTheThings) - Payload lists

### Cheat Sheets
- [Reverse Shell Cheat Sheet](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md)
- [Linux Privilege Escalation](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Linux%20-%20Privilege%20Escalation.md)
- [Windows Privilege Escalation](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Windows%20-%20Privilege%20Escalation.md)

### Tools
- [LinPEAS](https://github.com/carlospolop/PEASS-ng/tree/master/linPEAS)
- [WinPEAS](https://github.com/carlospolop/PEASS-ng/tree/master/winPEAS)
- [pwntools](https://github.com/Gallopsled/pwntools)

## Study Tips

1. **Practice Methodically** - Follow a consistent enumeration methodology
2. **Take Notes** - Document your findings and techniques
3. **Understand the "Why"** - Don't just run commands, understand what they do
4. **Build a Cheat Sheet** - Create your own reference of successful techniques
5. **Try Harder** - If stuck, enumerate more thoroughly before seeking hints

---

**Next Section:** [01 - System Enumeration](./01-enumeration/)
